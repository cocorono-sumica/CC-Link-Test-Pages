<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript遅延リダイレクトテストページ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            background: #f0f8ff;
        }
        .redirect-box {
            background: white;
            padding: 40px;
            margin: 20px 0;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        .redirect-box h1 {
            color: #667eea;
            margin-top: 0;
        }
        .redirect-icon {
            font-size: 5em;
            margin: 20px 0;
        }
        .countdown {
            font-size: 2.5em;
            color: #667eea;
            font-weight: bold;
            margin: 20px 0;
        }
        .info-box {
            background: #e7f3ff;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
            border-radius: 4px;
            text-align: left;
        }
        .code-block {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: monospace;
            margin: 15px 0;
        }
    </style>
    <script>
        // JavaScript遅延リダイレクト（3秒後）
        // 注意: 実際にはリダイレクトしません（テスト目的のため）
        // setTimeout(function() {
        //     window.location.href = "../index.html";
        // }, 3000);

        // 拡張機能がHTMLソースを解析してこのコードを検出します
        console.log('JavaScript delayed redirect detected: setTimeout with 3000ms delay');
    </script>
</head>
<body>
    <div style="background: #e8f5e9; border-left: 4px solid #4caf50; padding: 20px; margin: 20px; border-radius: 8px; text-align: left;">
        <h3 style="color: #2e7d32; margin-top: 0;">📊 期待される検出結果（このページ自体をチェックする場合）</h3>
        <p style="margin: 10px 0; font-size: 0.95em; color: #555;">
            <strong>総リンク数:</strong> 1 | <strong>✅ 正常:</strong> 1 | <strong>❌ エラー:</strong> 0
        </p>
        <p style="margin: 5px 0; font-size: 0.9em; color: #666;">
            💡 このページ自体はダッシュボードリンクのみです。
        </p>
        <p style="margin: 5px 0; font-size: 0.9em; color: #856404;">
            ⚠️ <strong>注:</strong> 他のページからこのページへのリンクをチェックすると、JavaScript遅延転送(5秒)が検出されます。
        </p>
    </div>

    <div class="redirect-box">
        <div class="redirect-icon">⏱️</div>
        <h1>JavaScript遅延リダイレクトテストページ</h1>
        <p style="font-size: 1.2em; color: #666;">
            このページにはJavaScriptによる遅延リダイレクトコードが含まれています
        </p>
        <p class="countdown">遅延時間: 3000ms (3秒)</p>
        <p style="color: #999; margin-top: 20px;">
            （実際のリダイレクトはテスト目的のため無効化されています）
        </p>
    </div>

    <div class="info-box">
        <h2 style="color: #667eea; margin-top: 0;">🔍 検証ポイント</h2>
        <ul style="line-height: 1.8; color: #555;">
            <li>HTTPステータスは200 OKですが、JavaScript遅延リダイレクトとして検出される</li>
            <li>リダイレクトタイプ: <code>javascript-delayed</code></li>
            <li>遅延時間: 3000ms (3秒)</li>
            <li>遅延時間が解析され、表示される</li>
            <li>コンテンツ分析情報に詳細が表示される</li>
        </ul>
    </div>

    <div class="info-box" style="background: #d1ecf1; border-left-color: #17a2b8;">
        <h2 style="color: #0c5460; margin-top: 0;">💡 JavaScript遅延リダイレクト</h2>
        <p style="color: #555; line-height: 1.8;">
            JavaScriptのsetTimeoutを使用した遅延リダイレクトです。以下のようなパターンが検出されます:
        </p>

        <div class="code-block">
// パターン1: setTimeout + location.href
setTimeout(function() {
    window.location.href = "url";
}, 3000);

// パターン2: setTimeout + location.replace
setTimeout(() => {
    window.location.replace("url");
}, 3000);

// パターン3: setInterval
setInterval(function() {
    location.href = "url";
}, 3000);
        </div>

        <p style="color: #555; line-height: 1.8; margin-top: 15px;">
            拡張機能は遅延時間（ミリ秒）も解析し、リダイレクト情報と共に表示します。
        </p>
    </div>

    <div class="info-box" style="background: #fff3cd; border-left-color: #ffc107;">
        <h2 style="color: #856404; margin-top: 0;">⚠️ 遅延リダイレクトの用途</h2>
        <p style="color: #555; line-height: 1.8;">
            遅延リダイレクトは以下のような場面で使用されます:
        </p>
        <ul style="color: #555; line-height: 1.8;">
            <li>フォーム送信後の完了メッセージを表示してからリダイレクト</li>
            <li>エラーメッセージを表示してからトップページに戻る</li>
            <li>広告や重要な通知を表示してからリダイレクト</li>
        </ul>
        <p style="color: #555; line-height: 1.8; margin-top: 15px;">
            しかし、ユーザー体験の観点からは、長すぎる遅延は避けるべきです。
        </p>
    </div>
</body>
</html>
